{
  "hash": "9cc3936f40ffcbbc16cfd2f0b9fee265",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 2\"\nformat: html\n---\n\n\n\n## Libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven)\nlibrary(descr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggcorrplot)\nlibrary(ggplot2)\n```\n:::\n\n\n\n## Load Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTEDS_2016 <- read_dta(\"https://github.com/datageneration/home/blob/master/DataProgramming/data/TEDS_2016.dta?raw=true\")\nTEDS_2016$PartyID <- factor(TEDS_2016$PartyID, labels = c(\"KMT\", \"DPP\", \"NP\", \"PFP\", \"TSU\", \"NPP\", \"NA\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(TEDS_2016$PartyID)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA  NA  KMT NA  NA  DPP\nLevels: KMT DPP NP PFP TSU NPP NA\n```\n\n\n:::\n\n```{.r .cell-code}\ntail(TEDS_2016$PartyID)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] NA  NA  DPP NA  NA  NA \nLevels: KMT DPP NP PFP TSU NPP NA\n```\n\n\n:::\n\n```{.r .cell-code}\nfreq(TEDS_2016$PartyID)\n```\n\n::: {.cell-output-display}\n![](assignment2.0_files/figure-html/party_id_analysis-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTEDS_2016$PartyID \n      Frequency  Percent\nKMT         388  22.9586\nDPP         591  34.9704\nNP            3   0.1775\nPFP          32   1.8935\nTSU           5   0.2959\nNPP          43   2.5444\nNA          628  37.1598\nTotal      1690 100.0000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nT2 <- TEDS_2016 %>%\n  count(PartyID) %>%\n  mutate(perc = n / sum(n))\n\nggplot(T2, aes(x = reorder(PartyID, -perc), y = perc, fill = PartyID)) +\n  geom_bar(stat = \"identity\") +\n  ylab(\"Party Support (%)\") +\n  xlab(\"Taiwan Political Parties\") +\n  theme_bw() +\n  scale_fill_manual(values = c(\"steelblue\", \"forestgreen\", \"khaki1\", \"orange\", \"goldenrod\", \"yellow\", \"grey\"))\n```\n\n::: {.cell-output-display}\n![](assignment2.0_files/figure-html/party_support_plot-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nTEDS_2016 <- TEDS_2016 %>%\n  mutate(female = ifelse(Sex == 2, 1, 0))\ntable(TEDS_2016$female)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  0   1 \n868 822 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor_vars <- TEDS_2016 %>% select(Tondu, female, age, DPP, income, edu, Taiwanese, Econ_worse)\ncor_matrix <- cor(cor_vars, use = \"pairwise.complete.obs\")\n\nggcorrplot(cor_matrix, \n           method = \"circle\", \n           type = \"lower\",\n           lab = TRUE,\n           colors = c(\"red\", \"white\", \"blue\"),\n           title = \"Correlation Matrix\")\n```\n\n::: {.cell-output-display}\n![](assignment2.0_files/figure-html/correlation_analysis-1.png){width=672}\n:::\n:::\n\n\n\n## Linear Regression\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(votetsai ~ female + age + DPP + income + edu + Taiwanese + Econ_worse, data = TEDS_2016)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = votetsai ~ female + age + DPP + income + edu + Taiwanese + \n    Econ_worse, data = TEDS_2016)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.07711 -0.23920 -0.02419  0.24106  0.86339 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  0.4408344  0.0727487   6.060  1.8e-09 ***\nfemale      -0.0256167  0.0209882  -1.221  0.22250    \nage         -0.0021676  0.0008307  -2.609  0.00918 ** \nDPP          0.4798515  0.0228743  20.978  < 2e-16 ***\nincome      -0.0035722  0.0039547  -0.903  0.36655    \nedu         -0.0232000  0.0095903  -2.419  0.01570 *  \nTaiwanese    0.2531388  0.0239856  10.554  < 2e-16 ***\nEcon_worse   0.0636800  0.0214794   2.965  0.00309 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.3663 on 1249 degrees of freedom\n  (433 observations deleted due to missingness)\nMultiple R-squared:  0.4306,\tAdjusted R-squared:  0.4274 \nF-statistic: 134.9 on 7 and 1249 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nTEDS_2016$Tondu <- factor(TEDS_2016$Tondu, levels = unique(TEDS_2016$Tondu), labels = c(\"Unification now\", \"Status quo, unif. in future\", \"Status quo, decide later\", \"Status quo forever\", \"Status quo, indep. in future\", \"Independence now\", \"No response\"))\nfrequency_table <- table(TEDS_2016$Tondu)\nprint(frequency_table)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n             Unification now  Status quo, unif. in future \n                         546                          380 \n    Status quo, decide later           Status quo forever \n                         121                          328 \nStatus quo, indep. in future             Independence now \n                         108                          180 \n                 No response \n                          27 \n```\n\n\n:::\n:::\n",
    "supporting": [
      "assignment2.0_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}